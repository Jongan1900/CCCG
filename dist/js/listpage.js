"use strict";$(function(){$(".comproli").click(function(){$(this).addClass("on").siblings(".comproli").removeClass("on");var a=$(this).index();$(".comprocon").eq(a).slideDown().siblings(".comprocon").slideUp()});var l=$("#list"),a=$("#pribtn"),i=$("#pagelist"),s=$("#pribtn"),o=0,t="",r="",n="";function e(a,s){$.ajax({type:"get",url:"../api/orderby.php",data:"page="+a+"&num=12&order="+s+"&type="+r+"&title="+n,success:function(a){!function(a){var s=JSON.parse(a);0==(c=JSON.parse(a)).total&&(alert("抱歉没有找到您搜索的内容，请换一个词吧"),location.href="../html/listpage.html");var t=s.goodlist.map(function(a){return"<li data-id="+a.id+'>\n                        <div class="goods　clearfix">\n                            <div class="img">\n                                <a href="##"><img src=.'+a.imgurl+' alt=""></a>\n                            </div>                \n                        <div class="name">\n                            <a href="##">\n                                <span>'+a.title+'</span>\n                                <strong></strong>\n                            </a>\n                        </div>\n                        <div class="pri">\n                            <span></span>\n                            <strong>¥'+a.price+'</strong>\n                            <p class="con fr"><small>'+a.xiaoliang+'</small>\n                            销量</p>\n                        </div>\n                        <div class="mpri clearfix">\n                            <small>\n                                市场价￥\n                                <del>'+a.oldprice+'</del>\n                            </small>\n                            <p class="con"><a href="#">'+a.message+'</a>\n                            人评论</p>\n                        </div>\n                        <div class="buy clearfix">\n                            <a href="../html/shopcart.html" target="_blank"  class="go fl">立即购买</a>\n                            <a href="##"     class="cat fr">加入购物车</a>\n                        </div>\n                        <div class="tag">\n                        </div>\n                    </div>\n                    </li>'}).join("");l.html(t);for(var r=Math.ceil(s.total/s.num),n="第 "+(o=s.page)+"页， 共 "+r+"页 [共"+s.total+"件商品]",e=0;e<r;e++)n+='<p><a href="javascript:;">'+(e+1)+"</a></p>";i.html(n),$(".delpage").html(o+"/"+r),$("label").html(s.total),$("#pagelist").find("p").removeClass("this"),$("#pagelist").find("p").eq(o-1).addClass("this")}(a)}})}$.ajax({type:"get",url:"../api/orderby.php",data:"type=xiaoliang&order=DESC&page=1&num=10",success:function(a){for(var s=JSON.parse(a).goodlist,t="",r=0;r<s.length;r++)t+='<li class="clearfix" data-id="'+s[r].id+'">\n                            <p class="img">\n                                <a href="##" >\n                                    <img src=".'+s[r].imgurl+'" alt="">\n                                </a>\n                            </p>\n                            <div class="rbox">\n                                <p class="txt">\n                                    <a href="##" >\n                                    '+s[r].title+'\n                                    </a>\n                                </p>\n                                <p class="pri">\n                                    <strong>¥'+s[r].price+"</strong>\n                                    <del>¥"+s[r].hcprice+"</del>\n                                </p>\n                            </div>\n                        </li>",$(".prolist").html(t)}}),e(1,t);var c=[];i.on("click","a",function(){e($(this).parent().index()+1,t)}),$(".pr").on("click",function(){if(1==o)return!1;e(o-1,t)}),$(".nex").on("click",function(){var a=$("#pagelist:last-child").index()-1;if(o==a)return!1;e(1*o+1,t)});var d=!0;a.on("click",function(){r="price",d?(t="ASC",s.value="降序",$(".sortbtn").addClass("down").removeClass("up").css({color:"#666",border:"1px solid #e8e8e8"}),$(this).addClass("up").removeClass("down").css({color:"#000",border:"1px solid rgb(96, 164, 17)"}),$(".send").html("价格:从低到高").css({color:"#fff",background:"rgb(96, 164, 17)"})):(t="DESC",s.value="升序",$(".sortbtn").addClass("down").removeClass("up"),$(this).addClass("down").removeClass("up"),$(".send").html("价格:从高到低").css("color","#fff")),d=!d,e(1,t)});var p=!0;$("#xlbtn").on("click",function(){r="xiaoliang",p?(t="ASC",$(".sortbtn").addClass("down").removeClass("up").css({color:"#666",border:"1px solid #e8e8e8"}),$(this).addClass("up").removeClass("down").css({color:"#000",border:"1px solid rgb(96, 164, 17)"}),$(".send").html("销量:从低到高").css({color:"#fff",background:"rgb(96, 164, 17)"})):(t="DESC",$(".sortbtn").addClass("down").removeClass("up"),$(this).addClass("down").removeClass("up"),$(".send").html("销量:从高到低").css("color","#fff")),p=!p,e(1,t)});var h=!0;$("#msgbtn").on("click",function(){r="message",h?(t="ASC",$(".sortbtn").addClass("down").removeClass("up").css({color:"#666",border:"1px solid #e8e8e8"}),$(this).addClass("up").removeClass("down").css({color:"#000",border:"1px solid rgb(96, 164, 17)"}),$(".send").html("评论数:从低到高").css({color:"#fff",background:"rgb(96, 164, 17)"})):(t="DESC",$(".sortbtn").addClass("down").removeClass("up"),$(this).addClass("down").removeClass("up"),$(".send").html("评论数:从高到低").css("color","#fff")),h=!h,e(1,t)}),l.on("click","span",function(){var a=$(this).parent().parent().parent().parent().attr("data-id");location.href="../html/goodlist.html?"+a}),l.on("click","img",function(){var a=$(this).parent().parent().parent().parent().attr("data-id");location.href="../html/goodlist.html?"+a}),$(".prolist").on("click","li",function(){var a=$(this).attr("data-id");location.href="../html/goodlist.html?"+a}),$("#list").on("click",".go",function(){var a=$(this).parent().parent().parent().attr("data-id"),s=v("username");if(!v("username"))return alert("您还未登录，请先登录"),!1;var t=c.goodlist[a-1],r=a-1;$.ajax({type:"post",url:"../api/cart.php",data:"shopid="+r+"&title="+t.title+"&price="+t.price+"&username="+s+"&hcprice="+t.hcprice+"&imgurl="+t.imgurl+"&num=1",success:function(a){var s=JSON.parse(a);$(".shopcart").html(s.cartnum).css("color","red")}})}),$("#list").on("click",".cat",function(){var a=$(this).parent().parent().parent().attr("data-id"),s=v("username");if(v("username")){var t=c.goodlist[a-1],r=a-1;$.ajax({type:"post",url:"../api/cart.php",data:"shopid="+r+"&title="+t.title+"&price="+t.price+"&username="+s+"&hcprice="+t.hcprice+"&imgurl="+t.imgurl+"&num=1",success:function(a){var s=JSON.parse(a);$(".shopcart").html(s.cartnum).css("color","red")}})}else alert("您还未登录，请先登录")}),$("#clearall").on("click","",function(){$("#checklist input").prop("checked",!1),e(1,"")});var u=!0,m=!0;$("#checklist").on("input","input",function(){switch($(this).parent().text().trim()){case"滋恩":u=(u?(r="title",n="滋恩",e(1,t="")):(n=r="",e(1,t)),!u);break;case"一品堂":m=(m?(r="title",n="一品堂",e(1,t="")):(n=r="",e(1,t)),!m)}}),$("#searchbtn").on("click",function(){var a=$(".search").val().trim();if(""==a)return $(".search").val(""),void $(".search").attr("placeholder","请输入想搜索的商品");r="title",n=a,e(1,t="")}),$(".search").keyup(function(a){var s=$(".search").val().trim();if(""==s)return $(".search").val(""),void $(".search").attr("placeholder","请输入想搜索的商品");13==a.keyCode&&(r="title",n=s,e(1,t=""))});var f=decodeURI(location.search).slice(1);function v(a){var s=document.cookie.split("; "),t=!0,r=!1,n=void 0;try{for(var e,l=s[Symbol.iterator]();!(t=(e=l.next()).done);t=!0){var i=e.value.split("=");if(a==i[0])return i[1]}}catch(a){r=!0,n=a}finally{try{!t&&l.return&&l.return()}finally{if(r)throw n}}}f&&(n=f,r="title",e(1,t=""))});