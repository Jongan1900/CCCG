"use strict";$(function(){$(".rgsbox").on("click",".rgsbtn",function(){$(this).addClass("on").siblings(".rgsbtn").removeClass("on");var t=$(this).index();$(".right_b").eq(t).addClass("disblock").siblings(".right_b").removeClass("disblock"),k(M)});var a=[0,0,0,0,0,0],i=!1,t=$("#resin li:first input"),l=$("#resin li:first span"),r=$("#resin li:first .input").val().trim();t.on("blur",function(){if(r=$("#resin li:first .input").val().trim(),l.html(""),""==r)return t.val(""),l.html("请输入你的手机号码"),void t.attr("placeholder","请输入内容");if(/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/.test(r)){$.ajax({type:"post",url:"../api/postdata.php",data:"name="+r+"&type=getname",success:function(t){"yes"==t?(l.html("该用户名可以注册").css("color","green"),a[0]=2,i=!0):"no"==t&&(l.html("该用户名已被注册").css("color","red"),a[0]=0,i=!1)}})}else!1,l.html("请输入正确的手机号码").css("color","red"),a[0]=0});var n=$("#resin li:nth-child(2) input"),e=$("#resin li:nth-child(2) span"),o=n.val().trim();o="";n.on("blur",function(){if(""==(o=n.val().trim()))return n.val(""),e.html("最少1个有效内容，长度不超过20个字").css("color","red"),void(a[1]=0);if(o.length<20&&1<=o.length){$.ajax({type:"post",url:"../api/postdata.php",data:"type=filter&nicheng="+o,success:function(t){"yes"==t?(e.html("昵称可以在用户中心修改！").css("color","green"),a[1]=2):(a[1]=0,e.html("请勿使用敏感词").css("color","red"))}})}else e.html("最少1个有效内容，长度不超过20个字").css("color","red"),a[1]=0});var s=$("#resin li:nth-child(3) input"),c=$("#resin li:nth-child(3) span"),h=!1,v=s.val().trim();s.on("input",function(){if(""==(v=s.val().trim()))s.val(""),s.attr("placeholder","请输入密码"),c.html("须以字母开头，6-16位数字和字母组成").css("color","red"),a[2]=0;else{var t=/^[a-zA-Z]\w{5,17}$/.test(v);c.html("验证中...").css("color","#ccc"),h=t?(c.html("密码通过").css("color","green"),i=!0,a[2]=2,!0):(c.html("须以字母开头，6-16位数字和字母组成").css("color","red"),i=!1,a[2]=0,!1)}});var d=$("#resin li:nth-child(4) input"),m=$("#resin li:nth-child(4) span");d.on("input",function(){clearInterval(r);var t=d.val().trim(),l=s.val().trim();if(""==t)d.val(""),d.attr("placeholder","请重复输入上面的密码"),m.html("请重复输入上面的密码").css("color","red"),a[3]=0;else if(l==t&&h){m.html("验证中...").css("color","#ccc");var r=setInterval(function(){m.html("密码通过").css("color","green"),clearInterval(r)},1e3);i=!0,a[3]=2}else{m.html("验证中...").css("color","#ccc");r=setInterval(function(){m.html("两次密码不一致").css("color","red"),clearInterval(r)},1e3);i=!1,a[3]=0}});var p=$("#resin li:nth-child(6) input"),u=$("#resin li:nth-child(6) span"),f=($("#qs").val(),p.val().trim());p.on("input",function(){""==(f=p.val().trim())?(p.val(""),u.html("请输入内容").css("color","red"),a[4]=0):i=f.length<20&&1<=f.length?(u.html("答案通过").css("color","green"),a[4]=2,!0):(u.html("长度不要超过20").css("color","red"),a[4]=0,!1)});var g=$("#resin li:nth-child(7) input"),y=$("#resin li:nth-child(7) span"),w=g.val().trim();g.on("input",function(){if(""==(w=g.val().trim()))g.val(""),g.attr("placeholder","请输入邮箱地址"),y.html("请输入正确邮箱").css("color","red"),a[5]=0;else{var t=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/.test(w);i=t?(y.html("邮箱通过").css("color","green"),a[5]=2,!0):(y.html("请输入正确邮箱").css("color","red"),a[5]=0,!1)}});var M=[];function b(t,l,r){var n=new Date;n.setDate(n.getDate()+r),document.cookie=t+"="+l+";expires="+n+";path=/"}function k(t){var l=$("#canvas").width(),r=$("#canvas").height(),n=document.getElementById("canvas"),e=n.getContext("2d");n.width=l,n.height=r;for(var a="A,B,C,E,F,G,H,J,K,L,M,N,P,Q,R,S,T,W,X,Y,Z,1,2,3,4,5,6,7,8,9,0".split(","),i=a.length,o=0;o<=3;o++){var s=Math.floor(Math.random()*i),c=30*Math.random()*Math.PI/180,h=a[s];t[o]=h.toLowerCase();var v=10+20*o,d=20+8*Math.random();e.font="bold 23px 微软雅黑",e.translate(v,d),e.rotate(c),e.fillStyle=x(),e.fillText(h,0,0),e.rotate(-c),e.translate(-v,-d)}for(o=0;o<=5;o++)e.strokeStyle=x(),e.beginPath(),e.moveTo(Math.random()*l,Math.random()*r),e.lineTo(Math.random()*l,Math.random()*r),e.stroke();for(o=0;o<=30;o++){e.strokeStyle=x(),e.beginPath();v=Math.random()*l,d=Math.random()*r;e.moveTo(v,d),e.lineTo(v+1,d+1),e.stroke()}}function x(){return"rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")"}k(M),$("#canvas").on("click",function(){k(M)}),$("#resinbtn").on("click",function(){var t=$(".input-val").val().toLowerCase(),l=M.join("");if(""==t)alert("请输入验证码！");else if(t==l){$(".input-val").val(""),k(M);var r=s.val().trim(),n=$("#resin li:first .input").val().trim(),e=$("#qs").val();if(a.every(function(t){return 2==t})&&6==a.length&&i){$.ajax({type:"post",url:"../api/postdata.php",data:"name="+n+"&nicheng="+o+"&psw="+r+"&qs="+e+"&answer="+f+"&email="+w+"&type=postdata",success:function(){alert("恭喜你成功注册"),location.href="../html/login.html"}})}else alert("请确认信息完整")}else alert("验证码错误！请重新输入！"),$(".input-val").val(""),k(M)}),$(".warmin").on("click",function(){var l=$(".login li:nth-child(1) input"),t=$(".login li:nth-child(1) span"),r=$(".login li:nth-child(2) input");if(""==l.val().trim())return l.val(""),t.html("请输入你的登录名").css("color","red"),void l.attr("placeholder","请输入内容");if(t.html(""),function(t){var l=document.cookie.split("; "),r=!0,n=!1,e=void 0;try{for(var a,i=l[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var o=a.value.split("=");if(t==o[0])return o[1]}}catch(t){n=!0,e=t}finally{try{!r&&i.return&&i.return()}finally{if(n)throw e}}}("username"))alert("请不要重复登录");else{$.ajax({type:"post",url:"../api/postdata.php",data:"name="+l.val()+"&psw="+r.val()+"&type=login",success:function(t){"yes"==t?(b("username",l.val(),7),b("psw",r.val(),7),alert("正在为您跳转到主页"),location.href="../index.html"):"no"==t&&alert("请输入正确的登录名和密码")}})}})});